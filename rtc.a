GETTIME = $FF50
I2CREADBYTE = $FEC6
I2C_DEV = $6F

RTC
RTC_SECONDS
!byte 0
RTC_MINUTES
!byte 0
RTC_HOURS
!byte 0

RTCI2C
!byte 0,0,0

!macro readI2c .byteOffset {
    ldx #I2C_DEV
    ldy #.byteOffset
    jsr I2CREADBYTE
    bcs i2cError
    sta RTCI2C + .byteOffset
}

getTimeI2C  
    +readI2c 0
    lda RTCI2C
    and #%01111111
    sta RTCI2C
    +readI2c 1
    +readI2c 2
i2cError
    rts

getTimeCall
    jsr GETTIME
    lda $05
    sta RTC_HOURS
    lda $06
    sta RTC_MINUTES
    lda $07
    sta RTC_SECONDS

    rts